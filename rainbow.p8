pico-8 cartridge // http://www.pico-8.com
version 30
__lua__
plt={12,13,14,8,9,10,11}
plt2={1,1,2,2,4,9,3}
ptn = 0
t=0

function _draw()
	cls()
	t+=0.01

	-- background
	fillp(▤\1|0b.011)
	rectfill(0,0,128,128,1)

	draw_rainbow()
	draw_txt()

	-- stats
	color(7)
	print(stat(1),0,0)

	-- static noise
	if t< 0.35 or flr(rnd(50)) > 48 then
		if t<0.35 then
			sfx(0)
		else
			sfx(flr(rnd(2)), 0, 0, 1+flr(rnd(3)))
		end
		for y=0,127 do
			memcpy(0x6000+y*64,0x6000-y+10*flr(rnd(10))*64,0x40)
		end
	end

	color(7)
	print("⬅️/➡️ pattern…"..ptn,60,120)
end

function _update()
	if ptn > 0 and btnp(0) then
		ptn-=1
	elseif ptn < 3 and btnp(1) then
		ptn+=1
	end
end

function get_color(x,y,sp)
	if ptn==0 then
		c=y
	elseif ptn==1 then
		c=(y+sp/x*0.5)
	elseif ptn==2 then
		c=y+2/sp
	elseif ptn==3 then
		c=x+sp%2
	else
		c=y
	end

	return c
end

function draw_rainbow()
	fillp(✽\1|0b.011)

	sp=4

	for y=0,15 do
		if ptn==1 then
			minx = 1
			maxx = 14
		elseif ptn==2 then
			minx = 2
			maxx = 13
		elseif ptn==3 then
			minx = 0
			maxx = 15
		else
			minx = y/2
			maxx = 15-y/2
		end

		for x=minx,maxx do
			if ptn == 3 then
				sp+=4*sin((x/16+y/32+t*100)*100)
			else
				sp+=4*sin(t+x*0.1*cos(t+y*0.01))
			end

			sp=mid(0,6,flr(sp))
			c=get_color(x,y,sp)

			if c%8 == 0 then
				c = 1
			end

			pal(5,plt2[c%8])
			pal(6,plt[c%8])

			if ptn==1 then
				spr(4+2*sin(t*x-y),x*8,y*8)
			else
				spr(sp,x*8,y*8)
			end
		end
	end
end

function draw_txt()
	//color(1)
	fillp(▤\1|0b.011)
	txtx=-64+((t*150)%192)
	txty=60

	// letter by letter
	for i=0,6 do
		x = (txtx+i*8)+1
		y = txty+3*sin(t+x/50)
		c = 3+flr(get_color(x,y,4))

		// shadow
		fillp(▒\1|0b.011)
		pal(6,1)
		pal(7,0)
		sx, sy = ((i+16)%16)*8, ((i+16)\16)*8
		sspr(sx,sy,8,16,x+1,y+2,8,18+6*cos(t+x/50))

		// txt
		pal(6,i+8)
		pal(7,7)
		fillp(▤\1|0b.011)
		sspr(sx,sy,8,16,x-2,y,8,18+6*cos(t+x/50))
	end

	pal()
	fillp()
end
__gfx__
00000000000000000000000000000000000000000000000000555500000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000550000056650005666650000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000005500000066000005665000566665056666665000000000000000000000000000000000000000000000000000000000000000000000000
00000000000660000056650000566600056666500666666056666665000000000000000000000000000000000000000000000000000000000000000000000000
00000000000660000056650000566600056666500666666056666665000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000005500000055000005665000566665056666665000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000550000056650005666650000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000555500000000000000000000000000000000000000000000000000000000000000000000000000
77600776777777767760000077777776777777767760077677777776000000000000000000000000000000000000000000000000000000000000000000000000
77600776777777767760000077777776777777767776777677777776000000000000000000000000000000000000000000000000000000000000000000000000
77600776760000007760000077600000776007767777777676000000000000000000000000000000000000000000000000000000000000000000000000000000
77600776760000007760000077600000776007767767677676000000000000000000000000000000000000000000000000000000000000000000000000000000
77600776777777767760000077600000776007767760077677777776000000000000000000000000000000000000000000000000000000000000000000000000
77676776777777767760000077600000776007767760077677777776000000000000000000000000000000000000000000000000000000000000000000000000
77676776760000007760000077600000776007767760077676000000000000000000000000000000000000000000000000000000000000000000000000000000
77676776760000007760000077600000776007767760077676000000000000000000000000000000000000000000000000000000000000000000000000000000
77777776777777767777777677777776777777767760077677777776000000000000000000000000000000000000000000000000000000000000000000000000
77777776777777767777777677777776777777767760077677777776000000000000000000000000000000000000000000000000000000000000000000000000
77777776777777767777777677777776777777767760077677777776000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
0002000008610096100a6100a610026100262002660016300162001610006101721000e1000e1000e1000e1000e1000e1000e1000e1000e3001e4000e3000e2000e5000e50000000000000000000000000000000
000200000761009610106200362008220000000163001630006200060000620000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
